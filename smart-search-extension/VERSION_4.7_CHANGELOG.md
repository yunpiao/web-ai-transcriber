# 版本 4.7 更新日志

## 🎉 新增功能：自动浏览记录

### 功能描述
新增了智能浏览记录功能，可以自动记录您浏览的网页内容，方便后续回顾和管理。

### 主要特性

1. **自动记录机制**
   - 当您在网页停留超过5秒时，自动保存页面信息
   - 只在页面可见状态下计时（切换标签页会暂停计时）
   - 智能防重复：同一标签页的同一URL只记录一次

2. **记录内容**
   - 页面标题
   - 完整URL
   - 网站图标（favicon）
   - 网页文本内容（完整提取）
   - 访问时间戳
   - 域名信息

3. **历史记录页面**
   - 现代化卡片式界面设计
   - 按日期智能分组（今天、昨天、本周、更早）
   - 实时搜索功能（支持标题、URL、域名）
   - 单条删除和批量清空功能
   - 数据导出功能（JSON格式）

4. **隐私保护**
   - 所有数据存储在本地（IndexedDB）
   - 不上传任何数据到服务器
   - 可随时关闭功能或清除数据
   - 功能默认关闭，需手动启用

### 技术实现

#### 新增文件
- `tracker.js` - 页面追踪脚本（content script）
- `db.js` - IndexedDB数据库管理模块
- `history.html` - 历史记录展示页面
- `history.js` - 历史记录管理脚本
- `FEATURE_USAGE.md` - 功能使用指南

#### 修改文件
- `manifest.json` - 添加权限（activeTab, tabs）和注册content script
- `background.js` - 添加消息监听和数据库操作
- `options.html` - 添加功能开关UI
- `options.js` - 添加配置项保存/读取逻辑

#### 新增权限
- `activeTab` - 获取当前激活标签页信息
- `tabs` - 访问标签页API

### 使用方法

1. **启用功能**
   - 打开扩展设置页面
   - 勾选"启用浏览记录功能（停留5秒自动记录网页内容）"
   - 点击保存

2. **查看记录**
   - 在设置页面点击"📖 查看浏览历史记录"链接
   - 或直接访问 history.html 页面

3. **管理记录**
   - 使用搜索框筛选记录
   - 点击标题或"访问"按钮打开网页
   - 使用"删除"按钮移除单条记录
   - 使用"清空所有记录"清除全部数据
   - 使用"导出数据"备份记录

### 数据存储

- **存储方式**：IndexedDB（浏览器本地数据库）
- **数据库名**：PageHistoryDB
- **存储对象**：pageHistory
- **存储容量**：取决于浏览器配额（通常几百MB到几GB）

### 性能影响

- 极小的CPU占用（仅在页面加载和计时时）
- 极小的内存占用（约几KB）
- 不影响页面加载速度
- 异步存储，不阻塞UI

### 兼容性

- Chrome 88+
- 支持所有网站（http/https）
- 不支持chrome://等特殊页面
- 隐身模式下不工作（扩展限制）

### 后续计划

- [ ] 添加导入功能
- [ ] 添加标签/分类功能
- [ ] 添加统计分析（访问时长、网站排名等）
- [ ] 添加收藏/星标功能
- [ ] 支持全文搜索
- [ ] 添加自动清理策略（如保留最近N天）

---

## 版本信息

- **版本号**：4.7
- **发布日期**：2025-10-21
- **更新类型**：功能新增

