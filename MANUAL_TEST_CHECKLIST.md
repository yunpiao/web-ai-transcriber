# 手动测试检查清单

## 🎯 测试目的

验证重构后修复的两个关键bug：
1. **Bug Fix 1**: 元素检查响应速度（500ms → 100ms）
2. **Bug Fix 2**: 提示词模板正确添加（skipPromptTemplate逻辑）

## ✅ 测试前准备

### 1. 加载扩展
1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `smart-search-extension` 目录

### 2. 配置提示词
1. 点击扩展图标旁的"详情"
2. 或右键扩展图标 → "选项"
3. 在"自定义提示词模板"中输入：
   ```
   【测试提示词】请优化以下文字：
   
   ```
4. 点击"保存"按钮
5. 确认看到"选项已保存"提示

## 📋 测试用例

### 测试用例 1: 验证响应速度

**目标**: 验证元素检查从500ms降到100ms，响应更快

**步骤**:
1. 打开任意网页（如 https://www.baidu.com）
2. 右键点击 → 选择"使用 AI 转写网页内容"
3. 等待 Qwen AI 页面打开
4. **观察**：从页面加载到输入框填充的时间

**预期结果**:
- ✅ 页面加载后**立即**（1秒内）填充内容
- ✅ 不应该有明显的等待延迟
- ✅ 输入框出现后**马上**就有内容

**判断标准**:
- 优秀：< 500ms
- 良好：< 2秒
- 不合格：> 3秒

**如何计时**:
- 用秒表或手机计时
- 从 Qwen 页面出现输入框开始
- 到看到内容填充完成

---

### 测试用例 2: 验证提示词添加（转写功能）

**目标**: 验证提示词被正确添加到内容前面

**步骤**:
1. 打开一个简单网页（如 https://example.com）
2. 右键 → "使用 AI 转写网页内容"
3. 等待 Qwen AI 页面打开并填充
4. **检查输入框内容**

**预期结果**:
```
【测试提示词】请优化以下文字：

Example Domain
This domain is for use in illustrative examples...
```

**验证点**:
- ✅ 提示词在**最前面**
- ✅ 提示词和网页内容之间有换行
- ✅ 网页内容完整

**常见错误**（已修复）:
- ❌ 提示词缺失
- ❌ 只有网页内容，没有提示词
- ❌ 提示词在中间或末尾

---

### 测试用例 3: 验证自动发送

**目标**: 验证内容填充后自动点击发送按钮

**步骤**:
1. 执行测试用例 2 的步骤 1-3
2. **不要手动操作**，只观察
3. 等待 2-3 秒

**预期结果**:
- ✅ 内容填充后，发送按钮**自动被点击**
- ✅ 输入框内容开始处理（可能看到loading状态）
- ✅ Qwen 开始生成回复

**判断标准**:
- 成功：无需手动点击，自动开始处理
- 失败：需要手动点击发送按钮

---

### 测试用例 4: 验证总结功能（不添加提示词）

**目标**: 验证skipPromptTemplate=true时不添加提示词

**步骤**:
1. 开启页面追踪功能：
   - 扩展选项 → 勾选"启用页面浏览追踪"→ 保存
2. 访问几个网页，停留 5 秒以上
3. 打开历史记录页面（右键扩展图标 → 选项 → 点击"历史记录"链接）
4. 点击"总结今日浏览"按钮
5. 等待 Qwen AI 页面打开

**预期结果**:
```
请帮我总结以下浏览记录（筛选条件：今天）...

1. [2025-10-23 15:30] Example Domain
   网址: https://example.com/
   ...
```

**验证点**:
- ✅ **没有**"【测试提示词】请优化以下文字："
- ✅ 直接是总结格式的文本
- ✅ 内容完整，包含所有浏览记录

---

## 🐛 问题排查

如果测试失败，检查以下内容：

### 1. 输入框没有填充
- 打开浏览器控制台（F12）
- 查看 Console 标签
- 搜索 "[智能搜索扩展]" 或 "[调试]"
- 查看错误信息

### 2. 提示词没有添加
- 检查扩展选项中的提示词是否保存
- 检查是否使用的是"转写"功能（右键菜单）
- 如果使用的是"总结"功能，提示词不应该出现

### 3. 响应太慢
- 检查 content.js 中的 TIMING.ELEMENT_CHECK_INTERVAL
- 应该是 100，不是 500
- 可以在扩展管理页面查看源代码

### 4. 自动发送不工作
- 检查 Qwen 页面的发送按钮选择器是否正确
- 打开控制台，手动运行：
  ```javascript
  document.querySelector('#send-message-button')
  ```
- 如果返回 null，说明选择器错误

## 📊 测试记录表

| 测试用例 | 日期 | 结果 | 响应时间 | 备注 |
|---------|------|------|---------|------|
| 响应速度 | | ☐ 通过 ☐ 失败 | ___ ms | |
| 提示词添加 | | ☐ 通过 ☐ 失败 | | |
| 自动发送 | | ☐ 通过 ☐ 失败 | | |
| 总结功能 | | ☐ 通过 ☐ 失败 | | |

## 🎬 演示视频（可选）

建议录制测试过程：
1. 使用 QuickTime Player 或其他录屏工具
2. 录制从右键菜单到内容填充的完整过程
3. 可以帮助发现潜在问题

## 📞 反馈

如果发现任何问题，请记录：
1. 具体操作步骤
2. 预期结果 vs 实际结果
3. 浏览器控制台的错误信息
4. Chrome 版本和操作系统

---

**最后更新**: 2025-10-23
**测试环境**: Chrome 扩展
**关键修复**: 
- ELEMENT_CHECK_INTERVAL: 500ms → 100ms
- promptTemplate: 始终加载，由 skipPromptTemplate 控制

