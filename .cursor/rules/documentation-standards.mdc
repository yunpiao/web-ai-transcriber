---
description: 文档编写规范和维护指南
globs: *.md,docs/**
---

# 文档编写规范

## 文档类型

项目应包含以下类型的文档：

### 1. README.md

参考 [README.md](mdc:README.md) - 项目入口文档

**必须包含**：
- 项目简介
- 主要功能列表
- 安装/使用说明
- 快速开始指南
- 开发指南
- 测试说明
- 贡献指南（如果开源）
- 许可证

**示例结构**：
```markdown
# 项目名称

简短的一句话描述。

## 功能特性

- 功能 1
- 功能 2
- 功能 3

## 安装

\`\`\`bash
# 安装步骤
\`\`\`

## 使用

### 基本使用

### 高级配置

## 开发

### 项目结构

### 本地开发

### 测试

## 贡献

## 许可证
```

### 2. CHANGELOG.md

记录所有版本的变更。

参考 [CHANGELOG_SUMMARY_FILTER.md](mdc:CHANGELOG_SUMMARY_FILTER.md) 和 [smart-search-extension/VERSION_4.8_CHANGELOG.md](mdc:smart-search-extension/VERSION_4.8_CHANGELOG.md)

**格式**：
```markdown
# 更新日志

所有值得注意的项目变更都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/)

## [Unreleased]

### Added
- 正在开发的新功能

## [4.8.0] - 2024-10-23

### Added
- 新增功能 A
- 新增功能 B

### Fixed
- 修复 bug X
- 修复 bug Y

### Changed
- 改进 Z

### Deprecated
- 废弃功能 W

### Removed
- 移除功能 V

### Security
- 安全修复
```

**变更类型**：
- `Added` - 新增功能
- `Changed` - 功能变更
- `Deprecated` - 即将废弃的功能
- `Removed` - 已移除的功能
- `Fixed` - bug 修复
- `Security` - 安全相关修复

### 3. API 文档

对于复杂的模块，提供 API 文档。

**示例** - 数据库模块文档：

```markdown
# 数据库 API

## initDB()

初始化数据库连接。

**返回**: `Promise<IDBDatabase>`

**示例**:
\`\`\`javascript
const db = await initDB();
\`\`\`

## addRecord(data)

添加新记录到数据库。

**参数**:
- `data` (Object) - 记录数据
  - `url` (string) - 页面 URL
  - `title` (string) - 页面标题
  - `content` (string, optional) - 页面内容

**返回**: `Promise<number>` - 记录 ID

**抛出**: 
- `Error` - 如果缺少必需字段

**示例**:
\`\`\`javascript
const id = await addRecord({
  url: 'https://example.com',
  title: 'Example Page'
});
console.log('记录 ID:', id);
\`\`\`
```

### 4. 功能说明文档

参考 [smart-search-extension/FEATURE_USAGE.md](mdc:smart-search-extension/FEATURE_USAGE.md)

为每个主要功能提供详细说明：

```markdown
# [功能名称]

## 功能概述

简短描述功能的作用。

## 使用方法

### 步骤 1
### 步骤 2

## 配置选项

| 选项 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| option1 | boolean | true | 说明1 |
| option2 | string | 'default' | 说明2 |

## 常见问题

### Q: 问题1
A: 答案1

### Q: 问题2
A: 答案2

## 技术细节

（可选）提供技术实现细节。
```

### 5. 架构文档

参考 [docs/DOCS_STRUCTURE.md](mdc:docs/DOCS_STRUCTURE.md)

说明项目架构和设计决策：

```markdown
# 架构设计

## 系统架构

\`\`\`
┌─────────────┐
│   Browser   │
└──────┬──────┘
       │
┌──────▼──────────────────┐
│   Chrome Extension      │
├─────────────────────────┤
│  - Background Script    │
│  - Content Scripts      │
│  - Extension Pages      │
└──────┬──────────────────┘
       │
┌──────▼──────┐
│  IndexedDB  │
└─────────────┘
\`\`\`

## 模块划分

### Background Script
职责：...

### Content Scripts
职责：...

## 数据流

1. 用户操作 → Content Script
2. Content Script → Background Script (消息)
3. Background Script → IndexedDB (存储)
4. IndexedDB → Extension Pages (显示)

## 设计决策

### 为什么使用 IndexedDB 而不是 chrome.storage？
...

### 为什么分离 tracker.js 和 content.js？
...
```

### 6. 测试文档

参考 [docs/TESTING.md](mdc:docs/TESTING.md)

```markdown
# 测试指南

## 测试策略

项目使用三层测试：
1. 单元测试 - 测试独立函数
2. 集成测试 - 测试模块交互
3. E2E 测试 - 测试完整流程

## 运行测试

\`\`\`bash
# 所有测试
npm run test:all

# 单元测试
npm run test:unit

# E2E 测试
npm run test:e2e
\`\`\`

## 编写测试

### 单元测试示例
### 集成测试示例
### E2E 测试示例

## 测试覆盖率

当前覆盖率：XX%

查看覆盖率报告：
\`\`\`bash
npm run test:coverage
open coverage/lcov-report/index.html
\`\`\`
```

## 文档编写规范

### 1. Markdown 格式

✅ **正确的格式**：

```markdown
# 一级标题

## 二级标题

### 三级标题

段落之间空一行。

- 列表项 1
- 列表项 2
  - 嵌套项

1. 有序列表 1
2. 有序列表 2

**粗体文本**

*斜体文本*

`代码`

\`\`\`javascript
// 代码块
const x = 1;
\`\`\`

[链接文本](https://example.com)

![图片描述](image.png)
```

### 2. 代码示例

- ✅ 提供完整可运行的代码
- ✅ 添加必要的注释
- ✅ 使用正确的语法高亮
- ❌ 不要使用伪代码（除非特殊说明）

```javascript
// ✅ 好的示例 - 完整且可运行
async function fetchData() {
  try {
    const response = await fetch('https://api.example.com/data');
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('获取数据失败:', error);
    throw error;
  }
}
```

```javascript
// ❌ 不好的示例 - 不完整
function fetchData() {
  // ... 获取数据
  return data;
}
```

### 3. 链接引用

对于项目内的文件，使用相对路径：

```markdown
参考 [background.js](../smart-search-extension/background.js)

详见 [测试指南](docs/TESTING.md)
```

对于 Cursor MDC 格式：

```markdown
参考 [smart-search-extension/background.js](mdc:smart-search-extension/background.js)
```

### 4. 表格格式

```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 值1 | 值2 | 值3 |
| 值4 | 值5 | 值6 |

对齐方式：
| 左对齐 | 居中 | 右对齐 |
|:-------|:----:|-------:|
| 左     | 中   | 右     |
```

### 5. 使用图标和表情

适当使用 emoji 提高可读性：

```markdown
- ✅ 推荐做法
- ❌ 不推荐做法
- ⚠️ 注意事项
- 💡 提示
- 🚀 性能优化
- 🐛 Bug 修复
- 📝 文档
- 🧪 测试
```

### 6. 注意事项和警告

```markdown
> **注意**: 这是一个重要提示。

> **警告**: 这个操作不可逆！

> **提示**: 你可以这样做...
```

## 文档维护

### 何时更新文档

- ✅ 添加新功能时 → 更新 README 和 CHANGELOG
- ✅ 修复 bug 时 → 更新 CHANGELOG
- ✅ 修改 API 时 → 更新 API 文档
- ✅ 重构代码时 → 更新架构文档
- ✅ 发布版本时 → 更新 CHANGELOG 和版本号

### 文档审查清单

提交前检查：

- [ ] 所有链接都可以正常访问
- [ ] 代码示例可以正常运行
- [ ] 没有拼写错误
- [ ] 格式正确（标题、列表、代码块）
- [ ] 截图（如果有）清晰可见
- [ ] 版本号和日期正确

### 保持文档同步

```bash
# 每次代码变更后，检查需要更新的文档
git status

# 提交时包含文档变更
git add smart-search-extension/background.js
git add README.md
git add CHANGELOG.md
git commit -m "feat: 添加新功能

更新相关文档"
```

## 特殊文档

### 问题跟踪文档

参考 [issues/](mdc:issues/) 目录

记录待解决或讨论的问题：

```markdown
# [功能名称]功能

## 背景

为什么需要这个功能？

## 需求

### 功能需求
1. 需求 1
2. 需求 2

### 技术需求
1. 技术点 1
2. 技术点 2

## 实现方案

### 方案 A
优点：
缺点：

### 方案 B（推荐）
优点：
缺点：

## 任务清单

- [ ] 任务 1
- [ ] 任务 2
- [ ] 测试
- [ ] 文档

## 参考资料

- [相关文档链接]
```

### 会话总结文档

参考 [SESSION_SUMMARY_*.md](mdc:SESSION_SUMMARY_2025-10-21.md)

记录开发过程中的重要决策：

```markdown
# [日期] 开发会话总结

## 完成的工作

1. 功能 A
   - 实现细节
   - 相关提交

2. Bug 修复 B
   - 问题描述
   - 解决方案

## 遇到的问题

### 问题 1
- 问题描述
- 解决方案
- 经验教训

## 下一步计划

- [ ] 任务 1
- [ ] 任务 2

## 技术笔记

记录有价值的技术细节。
```

### 快速开始文档

参考 [QUICKSTART.md](mdc:QUICKSTART.md)

为新开发者提供快速入门：

```markdown
# 快速开始

## 5分钟上手

### 1. 克隆项目
\`\`\`bash
git clone ...
\`\`\`

### 2. 安装依赖
\`\`\`bash
npm install
\`\`\`

### 3. 加载扩展
1. 打开 Chrome
2. 访问 chrome://extensions/
3. 启用"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 smart-search-extension 目录

### 4. 测试
\`\`\`bash
npm test
\`\`\`

## 常见任务

### 添加新功能
### 修改配置
### 调试扩展
```

## 文档模板

### 新功能文档模板

```markdown
# [功能名称]

版本: x.x.x
日期: YYYY-MM-DD
作者: [作者名]

## 概述

简短描述功能。

## 动机

为什么需要这个功能？

## 用户场景

作为 [用户类型]，
我想要 [功能]，
以便 [目的]。

## 功能说明

### 基本使用

### 高级配置

## 实现细节

### 技术栈
- 技术 1
- 技术 2

### 核心代码

\`\`\`javascript
// 关键代码示例
\`\`\`

### 数据结构

\`\`\`javascript
{
  field1: 'value',
  field2: 123
}
\`\`\`

## 测试

### 测试覆盖
- 单元测试：文件路径
- 集成测试：文件路径
- E2E测试：文件路径

### 测试结果
- 通过率：100%
- 覆盖率：85%

## 性能

### 性能指标
- 响应时间：< 100ms
- 内存占用：< 10MB

### 性能优化
- 优化点 1
- 优化点 2

## 已知问题

### 限制
1. 限制 1
2. 限制 2

### 待改进
1. 改进点 1
2. 改进点 2

## 参考资料

- [相关文档]
- [参考实现]
```

## 最佳实践

### 1. 保持简洁

- ✅ 用简短的句子
- ✅ 使用列表和表格
- ✅ 突出重点
- ❌ 避免冗长的段落

### 2. 面向受众

- **用户文档** → 简单易懂，避免技术细节
- **开发者文档** → 详细的技术说明
- **API 文档** → 完整的参数和示例

### 3. 保持更新

- 代码变更 → 立即更新文档
- 定期审查文档准确性
- 删除过时的文档

### 4. 使用版本标记

```markdown
> **版本 4.8+**：此功能在 4.8 版本中添加。

> **已废弃**：此 API 将在 5.0 版本中移除，请使用 newAPI()。
```

### 5. 提供多种视角

```markdown
## 快速示例
\`\`\`javascript
// 最简单的用法
\`\`\`

## 详细说明
... 详细解释 ...

## 高级用法
\`\`\`javascript
// 复杂场景
\`\`\`
```

## 文档审查

在 Pull Request 中审查文档：

- [ ] 文档是否完整？
- [ ] 示例是否正确？
- [ ] 格式是否统一？
- [ ] 链接是否有效？
- [ ] 是否易于理解？

## 参考资源

- [Google 技术写作指南](https://developers.google.com/tech-writing)
- [Write the Docs](https://www.writethedocs.org/)
- [Markdown Guide](https://www.markdownguide.org/)
